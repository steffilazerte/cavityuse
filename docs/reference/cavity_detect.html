<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Summarize light into bouts of cavity use — cavity_detect • cavityuse</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Summarize light into bouts of cavity use — cavity_detect" />

<meta property="og:description" content="Summarize light into bouts of cavity use" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cavityuse</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/steffilazerte/cavityuse">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Summarize light into bouts of cavity use</h1>
    <small class="dont-index">Source: <a href='http://github.com/steffilazerte/cavityuse/blob/master/R/cavity.R'><code>R/cavity.R</code></a></small>
    <div class="hidden name"><code>cavity_detect.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Summarize light into bouts of cavity use</p>
    
    </div>

    <pre class="usage"><span class='fu'>cavity_detect</span>(<span class='no'>data</span>, <span class='no'>sun</span>, <span class='kw'>loc</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>thresh_dark</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>thresh_light</span> <span class='kw'>=</span> <span class='fl'>60</span>, <span class='kw'>ambig_dark</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>ambig_light</span> <span class='kw'>=</span> <span class='fl'>25</span>, <span class='kw'>gap_cutoff</span> <span class='kw'>=</span> <span class='fl'>10</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Data frame. Raw light data. Requires two columns: "time" and
"light"</p></td>
    </tr>
    <tr>
      <th>sun</th>
      <td><p>Data frame. Detected sunrise and sunset events, output of
<code><a href='sun_detect.html'>sun_detect</a></code></p></td>
    </tr>
    <tr>
      <th>loc</th>
      <td><p>Numeric vector. Longitude and Latitude of the observations (if not
in the data, this must be provided).</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>Numeric. Number of points before and after a given observation to
use in the calculation of cavity use (similar to a running mean)</p></td>
    </tr>
    <tr>
      <th>thresh_dark</th>
      <td><p>Numeric. Light threshold for "in" (see details)</p></td>
    </tr>
    <tr>
      <th>thresh_light</th>
      <td><p>Numeric. Light threshold for "out" (see details)</p></td>
    </tr>
    <tr>
      <th>ambig_dark</th>
      <td><p>Numeric. Light threshold for "in_ambig" (see details)</p></td>
    </tr>
    <tr>
      <th>ambig_light</th>
      <td><p>Numeric. Light threshold for "out_ambig" (see details)</p></td>
    </tr>
    <tr>
      <th>gap_cutoff</th>
      <td><p>Numeric. Minimum number of sequential missing observations
defining a "gap" in the data record</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame summarizing light into bouts of cavity use, each with a
  start, end, and location designation.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><strong>Thresholds</strong>
  This function assigns points to four categories based on their light
  intensity: "in", "out", "in_ambig", "out_ambig", "ambig". The thresholds
  are used to determine which category a point is assigned to.</p>
<p></p><ul>
<li><p><strong>in:</strong> Light &lt;= thresh_dark</p></li>
<li><p><strong>out:</strong> Light &gt;= thresh_light</p></li>
<li><p><strong>in_ambig:</strong> thresh_dark &lt; Light &lt;= ambig_dark</p></li>
<li><p><strong>out_ambig:</strong> thresh_light &gt; Light &gt;= ambig_light</p></li>
<li><p><strong>ambig:</strong> ambig_dark &lt; Light &lt; ambig_light</p></li>
</ul>
    <p>These points are then smoothed into bouts of cavity use. The argument
 <code>n</code>, determines how many points before and after a given point, should
 be used to influence the final cavity use designation. For example, an
 "ambig" point, surrounded by "in" points will be assigned as part of an "in"
 cavity use bout. However, 3 "ambig" points in a row will result in an
 "ambig" bout. How many points to smooth over is affected by <code>n</code>. The
 argument <code>gap_cutoff</code> determines the maximum number of minutes between
 observations allowed before a bout is split and a gap in the data is
 introduced.</p>
<p>To detect cavity use in the evening and overnight, this function relies on
 detections of sunrise and sunset (detected with <code><a href='sun_detect.html'>sun_detect</a></code>).
 If you really don't want to use this, assign an empty data frame, but be
 aware that your overnight locations will always be defined as "in", which,
 in many cases would be incorrect.
 <code>sun = data.frame()</code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Single individual</span>
<span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sun_detect.html'>sun_detect</a></span>(<span class='no'>wtsp</span>)
<span class='no'>e</span> <span class='kw'>&lt;-</span> <span class='fu'>cavity_detect</span>(<span class='no'>wtsp</span>, <span class='kw'>sun</span> <span class='kw'>=</span> <span class='no'>s</span>)

<span class='fu'><a href='cavity_plot.html'>cavity_plot</a></span>(<span class='no'>wtsp</span>, <span class='kw'>cavity</span> <span class='kw'>=</span> <span class='no'>e</span>, <span class='kw'>sun</span> <span class='kw'>=</span> <span class='no'>s</span>)</div><div class='img'><img src='cavity_detect-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Use map from purrr package for multiple individuals</span>
<span class='fu'>library</span>(<span class='no'>dplyr</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘dplyr’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    filter, lag</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    intersect, setdiff, setequal, union</span></div><div class='input'><span class='fu'>library</span>(<span class='no'>tidyr</span>)
<span class='fu'>library</span>(<span class='no'>purrr</span>)

<span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='no'>flicker_mult</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://www.rdocumentation.org/packages/tidyr/topics/nest'>nest</a></span>(-<span class='no'>id</span>, <span class='kw'>.key</span> <span class='kw'>=</span> <span class='st'>"light_data"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='kw'>s</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/purrr/topics/map'>map</a></span>(<span class='no'>light_data</span>, ~<span class='fu'><a href='sun_detect.html'>sun_detect</a></span>(<span class='no'>.</span>)),
         <span class='kw'>e</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/purrr/topics/map2'>map2</a></span>(<span class='no'>light_data</span>, <span class='no'>s</span>, ~<span class='fu'>cavity_detect</span>(<span class='no'>.x</span>, <span class='kw'>sun</span> <span class='kw'>=</span> <span class='no'>.y</span>)))
<span class='no'>d</span></div><div class='output co'>#&gt; # A tibble: 2 x 4
#&gt;   id        light_data           s                e                 
#&gt;   &lt;chr&gt;     &lt;list&gt;               &lt;list&gt;           &lt;list&gt;            
#&gt; 1 flicker_c &lt;tibble [3,600 × 5]&gt; &lt;tibble [1 × 6]&gt; &lt;tibble [213 × 9]&gt;
#&gt; 2 flicker_b &lt;tibble [2,160 × 5]&gt; &lt;tibble [6 × 6]&gt; &lt;tibble [316 × 9]&gt;</div><div class='input'>
<span class='fu'><a href='cavity_plot.html'>cavity_plot</a></span>(<span class='no'>d</span>$<span class='no'>light_data</span><span class='kw'>[[</span><span class='fl'>1</span>]], <span class='kw'>cavity</span> <span class='kw'>=</span> <span class='no'>d</span>$<span class='no'>e</span><span class='kw'>[[</span><span class='fl'>1</span>]], <span class='kw'>sun</span> <span class='kw'>=</span> <span class='no'>d</span>$<span class='no'>s</span><span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='img'><img src='cavity_detect-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='cavity_plot.html'>cavity_plot</a></span>(<span class='no'>d</span>$<span class='no'>light_data</span><span class='kw'>[[</span><span class='fl'>2</span>]], <span class='kw'>cavity</span> <span class='kw'>=</span> <span class='no'>d</span>$<span class='no'>e</span><span class='kw'>[[</span><span class='fl'>2</span>]], <span class='kw'>sun</span> <span class='kw'>=</span> <span class='no'>d</span>$<span class='no'>s</span><span class='kw'>[[</span><span class='fl'>2</span>]])</div><div class='img'><img src='cavity_detect-3.png' alt='' width='700' height='433' /></div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Steffi LaZerte.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

